---
description: 
globs: 
alwaysApply: false
---
# ì„œë¹„ìŠ¤ ê´€ë¦¬ ë° ë°°í¬ ê·œì¹™

## ğŸš¨ **ì ˆëŒ€ í•˜ì§€ ë§ ê²ƒ**

### 1. **ê¸°ì¡´ ì„œë¹„ìŠ¤ í™•ì¸ ì—†ì´ ìƒˆ ì„œë¹„ìŠ¤ ìƒì„± ê¸ˆì§€**
```bash
# ì˜ëª»ëœ ì˜ˆì‹œ - ì ˆëŒ€ í•˜ì§€ ë§ˆì„¸ìš”!
# ê¸°ì¡´ ì„œë¹„ìŠ¤ í™•ì¸ ì—†ì´ ë°”ë¡œ ìƒˆ ì„œë¹„ìŠ¤ ìƒì„±
sudo systemctl start new-service
```

**ë°˜ë“œì‹œ ë¨¼ì € í™•ì¸í•  ê²ƒ:**
```bash
# 1. ê¸°ì¡´ ì„œë¹„ìŠ¤ ëª©ë¡ í™•ì¸
sudo systemctl list-units --type=service | grep -i [í”„ë¡œì íŠ¸ëª…]

# 2. í¬íŠ¸ ì‚¬ìš© í˜„í™© í™•ì¸
sudo netstat -tlnp | grep [í¬íŠ¸ë²ˆí˜¸]

# 3. ê´€ë ¨ í”„ë¡œì„¸ìŠ¤ í™•ì¸
sudo ps aux | grep [í”„ë¡œì íŠ¸ëª…]
```

### 2. **WorkingDirectory ì„¤ì • ì‹¤ìˆ˜ ê¸ˆì§€**
- ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— package.jsonì´ ì—†ëŠ”ë° ë£¨íŠ¸ì—ì„œ npm ì‹¤í–‰ ì‹œë„ ê¸ˆì§€
- ë°±ì—”ë“œ/í”„ë¡ íŠ¸ì—”ë“œ ë¶„ë¦¬ êµ¬ì¡°ì—ì„œ ì˜¬ë°”ë¥¸ ë””ë ‰í† ë¦¬ ì„¤ì • í•„ìˆ˜

### 3. **ê°œë°œ/í”„ë¡œë•ì…˜ ëª¨ë“œ í˜¼ë™ ê¸ˆì§€**
- í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ `npm run dev` ì‹¤í–‰ ê¸ˆì§€
- ë°˜ë“œì‹œ `npm run start` ë˜ëŠ” ì ì ˆí•œ í”„ë¡œë•ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©

### 4. **í¬íŠ¸ ì¶©ëŒ ë¬´ì‹œ ê¸ˆì§€**
- EADDRINUSE ì—ëŸ¬ ë°œìƒ ì‹œ ë°˜ë“œì‹œ ê¸°ì¡´ ì„œë¹„ìŠ¤/í”„ë¡œì„¸ìŠ¤ í™•ì¸
- í¬íŠ¸ ë³€ê²½ë³´ë‹¤ëŠ” ê¸°ì¡´ ì„œë¹„ìŠ¤ ì •ë¦¬ ìš°ì„ 

## âœ… **ë°˜ë“œì‹œ í•  ê²ƒ**

### 1. **ì„œë¹„ìŠ¤ ìƒì„±/ìˆ˜ì • ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸**
```bash
# 1ë‹¨ê³„: ê¸°ì¡´ ì„œë¹„ìŠ¤ í™•ì¸
sudo systemctl list-units --type=service | grep -i amica

# 2ë‹¨ê³„: í¬íŠ¸ ì‚¬ìš© í™•ì¸
sudo netstat -tlnp | grep 3101

# 3ë‹¨ê³„: í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸
ls -la package.json  # ë£¨íŠ¸ì— ìˆëŠ”ì§€ í™•ì¸
ls -la backend/package.json  # ë°±ì—”ë“œì— ìˆëŠ”ì§€ í™•ì¸
ls -la frontend/package.json  # í”„ë¡ íŠ¸ì—”ë“œì— ìˆëŠ”ì§€ í™•ì¸
```

### 2. **ì˜¬ë°”ë¥¸ ì„œë¹„ìŠ¤ ì„¤ì • ìˆœì„œ**
```bash
# 1. ê¸°ì¡´ ì„œë¹„ìŠ¤ ì¤‘ì§€
sudo systemctl stop [ê¸°ì¡´-ì„œë¹„ìŠ¤ëª…]

# 2. ì„œë¹„ìŠ¤ ì„¤ì • íŒŒì¼ ìˆ˜ì • (tmpì—ì„œ)
# 3. ì„¤ì • íŒŒì¼ ë³µì‚¬
sudo cp /home/purestory/tmp/service.conf /etc/systemd/system/

# 4. systemd ë¦¬ë¡œë“œ
sudo systemctl daemon-reload

# 5. ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start [ì„œë¹„ìŠ¤ëª…]

# 6. ìƒíƒœ í™•ì¸
sudo systemctl status [ì„œë¹„ìŠ¤ëª…]
```

### 3. **ì„œë¹„ìŠ¤ ì„¤ì • í…œí”Œë¦¿**
```ini
[Unit]
Description=Amica AI Virtual Assistant
After=network.target
Wants=network.target

[Service]
Type=simple
User=purestory
Group=purestory
WorkingDirectory=/home/purestory/amica/backend  # ì˜¬ë°”ë¥¸ ë””ë ‰í† ë¦¬!
Environment=NODE_ENV=production  # í”„ë¡œë•ì…˜ í™˜ê²½!
Environment=PORT=3101
ExecStart=/home/purestory/.nvm/versions/node/v22.14.0/bin/npm run start  # start, dev ì•„ë‹˜!
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
```

## ğŸ”§ **íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ**

### 1. **EADDRINUSE ì—ëŸ¬ í•´ê²°**
```bash
# 1. í¬íŠ¸ ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ í™•ì¸
sudo netstat -tlnp | grep [í¬íŠ¸ë²ˆí˜¸]

# 2. í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ê°€ ì„œë¹„ìŠ¤ì¸ì§€ í™•ì¸
sudo systemctl list-units --type=service | grep -i [í”„ë¡œì íŠ¸ëª…]

# 3. ì„œë¹„ìŠ¤ë©´ ì¤‘ì§€, ì¼ë°˜ í”„ë¡œì„¸ìŠ¤ë©´ kill
sudo systemctl stop [ì„œë¹„ìŠ¤ëª…]
# ë˜ëŠ”
sudo kill [PID]
```

### 2. **package.json ì—†ìŒ ì—ëŸ¬ í•´ê²°**
```bash
# 1. í˜„ì¬ ë””ë ‰í† ë¦¬ í™•ì¸
pwd

# 2. package.json ìœ„ì¹˜ í™•ì¸
find . -name "package.json" -type f

# 3. ì„œë¹„ìŠ¤ WorkingDirectory ìˆ˜ì •
# /etc/systemd/system/[ì„œë¹„ìŠ¤ëª…].service ì—ì„œ
# WorkingDirectoryë¥¼ ì˜¬ë°”ë¥¸ ê²½ë¡œë¡œ ë³€ê²½
```

### 3. **ì„œë¹„ìŠ¤ ë¡œê·¸ í™•ì¸**
```bash
# ìµœê·¼ ë¡œê·¸ í™•ì¸
sudo journalctl -u [ì„œë¹„ìŠ¤ëª…] -n 20 --no-pager

# ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
sudo journalctl -u [ì„œë¹„ìŠ¤ëª…] -f
```

## ğŸ“‹ **Amica í”„ë¡œì íŠ¸ íŠ¹í™” ê·œì¹™**

### 1. **ì„œë¹„ìŠ¤ ì´ë¦„ ê·œì¹™**
- ë©”ì¸ ì„œë¹„ìŠ¤: `amica.service`
- ë°±ì—”ë“œë§Œ: `amica-backend.service` (ê¸°ì¡´)
- ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•´ í•˜ë‚˜ë§Œ ì‚¬ìš©

### 2. **í¬íŠ¸ í• ë‹¹**
- ë°±ì—”ë“œ API: 3101
- í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì„œë²„: 5173 (Vite)
- nginx í”„ë¡ì‹œ: 80, 443

### 3. **ë””ë ‰í† ë¦¬ êµ¬ì¡°**
```
/home/purestory/amica/
â”œâ”€â”€ backend/          # ë°±ì—”ë“œ (Express.js)
â”‚   â”œâ”€â”€ package.json  # npm run start ì‚¬ìš©
â”‚   â””â”€â”€ src/server.js
â”œâ”€â”€ frontend/         # í”„ë¡ íŠ¸ì—”ë“œ (React + Vite)
â”‚   â”œâ”€â”€ package.json  # npm run build í›„ ì •ì  íŒŒì¼
â”‚   â””â”€â”€ dist/         # ë¹Œë“œëœ íŒŒì¼ë“¤
â””â”€â”€ tmp/              # ì„ì‹œ ì„¤ì • íŒŒì¼ë“¤
```

## âš ï¸ **ì‹¤ìˆ˜ ë°©ì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸**

ì„œë¹„ìŠ¤ ê´€ë ¨ ì‘ì—… ì „ ë°˜ë“œì‹œ í™•ì¸:
- [ ] ê¸°ì¡´ ì„œë¹„ìŠ¤ ëª©ë¡ í™•ì¸í–ˆëŠ”ê°€?
- [ ] í¬íŠ¸ ì‚¬ìš© í˜„í™© í™•ì¸í–ˆëŠ”ê°€?
- [ ] package.json ìœ„ì¹˜ í™•ì¸í–ˆëŠ”ê°€?
- [ ] WorkingDirectoryê°€ ì˜¬ë°”ë¥¸ê°€?
- [ ] í”„ë¡œë•ì…˜ ëª¨ë“œë¡œ ì„¤ì •í–ˆëŠ”ê°€?
- [ ] ê¸°ì¡´ ì„œë¹„ìŠ¤ ì¤‘ì§€í–ˆëŠ”ê°€?

---

**âš ï¸ ì´ ê·œì¹™ì„ ì§€í‚¤ì§€ ì•Šìœ¼ë©´ ì„œë¹„ìŠ¤ ì¶©ëŒê³¼ ë°°í¬ ì‹¤íŒ¨ê°€ ë°œìƒí•œë‹¤!**
